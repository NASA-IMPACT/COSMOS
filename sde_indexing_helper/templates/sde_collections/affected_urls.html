{% extends "layouts/base.html" %}
{% load static i18n %}
{% load humanize %}
{% block title %}
Affected URLs
{% endblock title %}

{% block stylesheets %}
    {{ block.super }}
    <link href="//cdn.datatables.net/v/bs4/jszip-3.10.1/dt-2.0.5/af-2.7.0/b-3.0.2/b-colvis-3.0.2/b-html5-3.0.2/b-print-3.0.2/cr-2.0.1/fc-5.0.0/fh-4.0.1/kt-2.12.0/r-3.0.2/rg-1.5.0/rr-1.5.0/sc-2.4.1/sp-2.3.1/sl-2.0.1/datatables.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/plug-ins/2.0.8/features/inputPaging/dist/dataTables.inputPaging.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'css/affected_urls.css' %}" />
    <link href="{% static 'css/project.css' %}" rel="stylesheet">
{% endblock stylesheets %}

{% block content %}
    {% csrf_token %}
    <div class="headerDiv">
        <h1 class="pageTitle">Affected URLs</h1>
    </div>

    <h3 class="whiteText candidateTitle">
    {{ url_count }} affected URLs for exclude pattern: <strong>{{ pattern.match_pattern }}</strong>
    </h3>

    <div class="container mt-4">
        <!-- Table to display the URLs -->
        <table id="affectedURLsTable" class="table table-striped table-bordered" style="width:100%">
            <thead class="tableHeader">
                <tr>
                    <th scope="col" class="text-center col-1">#</th>
                    <th scope="col" class="text-center col-2">URL</th>
                    <!-- <th scope="col" class="text-center col-4">Is Included?</th> -->
                    <th scope="col" class="text-center col-3">Include URL</th> <!-- New Column -->
                </tr>
            </thead>
            <tbody>
                {% for url in affected_urls %}
                    <tr>
                        <!-- <td class="col-3 text-center">
                            <a class="exclude_individual_url" value="astrobiology.nasa.gov/about/">
                                <i class="material-icons" style="color: red">close</i></a>
                        </td> -->
                        <td class="text-center">{{ forloop.counter }}</td>
                        <td>
                            <a href="{{ url.url }}" target="_blank">{{ url.url }}</a>
                        </td>  
                        <!-- <td> {{ url.is_included }} </td>                       -->
                        <td class="col-3 text-center data-sort="0">
                            <a class="include-url-btn" data-url-id="{{ url.id }}" value = "{{url.url}}">
                            {% if url.is_included %}
                                <i class="material-icons tick-mark" style="color: green">check</i></a>
                                <!-- <span class="tick-mark">&#10004;</span>  Tick Mark if included -->
                            {% else %}
                            <i class="material-icons cross-mark" style="color: red">close</i></a>
                                <!-- <span class="cross-mark">&#10060;</span>  Cross Mark if not included -->
                            {% endif %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="3" class="text-center">No URLs were affected by this pattern.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Pagination controls -->
        <!-- <div class="pagination-container">
            <div class="pagination">
                <span class="step-links">
                    {% if page_obj.has_previous %}
                        <a href="?page=1">&laquo; first</a>
                        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
                    {% endif %}

                    <span class="current">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                    </span>

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">next</a>
                        <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                    {% endif %}
                </span>
            </div>
        </div>
    </div> -->
{% endblock content %}

{% block javascripts %}
    {{ block.super }}
    <script>var collection_id = "{{ collection.id }}";</script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="//cdn.datatables.net/v/bs4/jszip-3.10.1/dt-2.0.5/af-2.7.0/b-3.0.2/b-colvis-3.0.2/b-html5-3.0.2/b-print-3.0.2/cr-2.0.1/fc-5.0.0/fh-4.0.1/kt-2.12.0/r-3.0.2/rg-1.5.0/rr-1.5.0/sc-2.4.1/sp-2.3.1/sl-2.0.1/datatables.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.70/jquery.blockUI.min.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/2.0.8/features/inputPaging/dist/dataTables.inputPaging.min.js"></script>
    <script src="{% static 'js/affected_urls.js' %}"></script>
    <script src="{% static 'js/project.js' %}"></script>
    <script src="{% static 'js/core/bootstrap.min.js' %}"></script>

    <!-- <script>
        // Function to toggle between cross and tick marks
        document.querySelectorAll('.include-url-btn').forEach(function(button) {
            button.addEventListener('click', function() {
                const span = this.querySelector('span');
                if (span.classList.contains('cross-mark')) {
                    // Change to tick mark
                    span.classList.remove('cross-mark');
                    span.innerHTML = '&#10004;';  // Tick mark
                } else {
                    // Change back to cross mark
                    span.classList.add('cross-mark');
                    span.innerHTML = '&#10060;';  // Cross mark
                }
            });
        });
    </script> -->

{% endblock javascripts %}